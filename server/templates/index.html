<!doctype html>
<html lang="en">
        <head>
                <meta charset="utf-8" />
                <meta name="viewport" content="width=device-width, initial-scale=1" />
                <title>Elder Safety Dashboard</title>
                <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />

                <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
                <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

                <script defer src="{{ url_for('static', filename='app.js') }}"></script>
        </head>

        <body>
                <header class="header">
                        <div class="title">
                                <h1>üè• Elder Care Monitor</h1>
                                <p>Real-time MQTT Stream</p>
                        </div>

                        <div class="right">
                                <div class="chip">Last Event: <strong id="lastUpdate">--:--:--</strong></div>
                                <div class="chip">Status: <span id="systemStatus" class="badge ok">Connecting...</span></div>
                        </div>
                </header>

                <main class="main">
                        <section class="cards">
                                <article class="card">
                                        <div class="label">Active Devices</div>
                                        <div class="value" id="statDevices">0</div>
                                </article>
                                <article class="card">
                                        <div class="label">Temperature</div>
                                        <div class="value"><span id="statAvgTemp">-</span> <span class="unit">¬∞C</span></div>
                                </article>
                                <article class="card">
                                        <div class="label">Humidity</div>
                                        <div class="value"><span id="statAvgHum">-</span> <span class="unit">%</span></div>
                                </article>
                        </section>

                        <section class="grid">
                                <article class="panel">
                                        <div class="panelHeader">
                                                <h2>Active Units</h2>
                                        </div>
                                        <div class="tableWrap">
                                                <table>
                                                        <thead>
                                                                <tr>
                                                                        <th>Device ID</th>
                                                                        <th>Type</th>
                                                                        <th>Battery</th>
                                                                        <th>Last Seen</th>
                                                                        <th>Status</th>
                                                                </tr>
                                                        </thead>
                                                        <tbody id="telemetryRows"></tbody>
                                                </table>
                                        </div>
                                </article>
                                <article class="panel">
                                        <div class="panelHeader">
                                                <h2>SendMessage to Bedside</h2>
                                        </div>
                                        <div style="padding: 15px; display: flex; flex-direction: column; gap: 10px;">
                                                <input type="text" id="msgInput" placeholder="Ex: Take your medicine..." 
                                                                                                                                 style="padding: 10px; border: 1px solid #ccc; border-radius: 6px;">

                                                <div style="display: flex; gap: 10px;">
                                                        <button onclick="sendMsg('green')" style="flex:1; padding: 10px; background: #2b7a56; color: white; border: none; border-radius: 6px; cursor: pointer;">Normal (Green)</button>
                                                        <button onclick="sendMsg('red')" style="flex:1; padding: 10px; background: #d64541; color: white; border: none; border-radius: 6px; cursor: pointer;">Urgent (Red)</button>
                                                </div>
                                                <div id="msgStatus" class="small" style="text-align: center; margin-top: 5px; opacity: 0;">Sent!</div>
                                        </div>
                                </article>
                                <article class="panel">
                                        <div class="panelHeader">
                                                <h2>Live Alert Feed</h2>
                                        </div>
                                        <div class="alerts" id="alertsList">
                                                <div class="small" style="padding:10px">Waiting for events...</div>
                                        </div>
                                </article>
                        </section>
                </main>

                <footer class="footer">
                        ¬© 2026 Elder Care System | MQTT + Flask + WebSockets
                </footer>
        </body>
</html>
